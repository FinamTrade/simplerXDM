(function(i,H){function v(){}function C(a,c,e){i.addEventListener?a.postMessage(c,e):setTimeout(function(){a.postMessage(c,e)},0)}function w(a,c,e){a.addEventListener?a.addEventListener(c,e,!1):a.attachEvent("on"+c,e)}function x(a,c,e){a.removeEventListener?a.removeEventListener(c,e,!1):a.detachEvent("on"+c,e)}function s(a){if(/^file:/.test(a))throw"The file:// protocol is not supported";var c=a.toLowerCase().match(/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/),a=c[2],e=c[3],c=c[4]||"";if("http:"==a&&":80"==
c||"https:"==a&&":443"==c)c="";return a+"//"+e+c}function q(a,c){for(var e in c)c.hasOwnProperty(e)&&(a[e]=c[e]);return a}var y=i.document,r=i.location,k=i.finamtrade;k||(i.finamtrade=k={});if(!k.XDM){if(!Array.isArray){var z=Object.prototype.toString;Array.isArray=function(a){return"[object Array]"==z.call(a)}}k.XDM=function(a){function c(f){var a;if(f.origin)a=s(f.origin);else if(f.uri)a=s(f.uri);else if(f.domain)a=r.protocol+"//"+f.domain;else throw"Unable to retrieve the origin of the event";
if(a==t&&f.data.substring(0,j.length+1)==j+" ")if(f=f.data.substring(j.length+1),f=JSON.parse(f),f.method){var b=f.id;a=D[f.method];f=f.params;if(a){var c,d;b?(c=function(a){c=v;k({id:b,result:a})},d=function(a,f){d=v;var c={id:b,error:{code:-32099,message:a}};f&&(c.error.data=f);k(c)}):c=d=v;Array.isArray(f)||(f=[f]);try{var e=a.apply(l,f.concat([c,d]));e!==H&&c(e)}catch(g){d(g.message)}}else b&&k({id:b,error:{code:-32601,message:"Procedure not found."}})}else e=A[f.id],f.error?e.error&&e.error(f.error):
e.success&&e.success(f.result),delete A[f.id]}function e(f){if(f.data==j+"-ready"&&(u="postMessage"in m.contentWindow?m.contentWindow:m.contentWindow.document,x(i,"message",e),w(i,"message",c),"function"==typeof a.onReady))a.onReady()}function k(a){C(u,j+" "+JSON.stringify(a),t)}function z(a){var c=Array.prototype.slice;return function(){var b=arguments.length,e,d={method:a};0<b&&"function"==typeof arguments[b-1]?(1<b&&"function"==typeof arguments[b-2]?(e={success:arguments[b-2],error:arguments[b-
1]},d.params=c.call(arguments,0,b-2)):(e={success:arguments[b-1]},d.params=c.call(arguments,0,b-1)),A[""+ ++E]=e,d.id=E):d.params=c.call(arguments,0);k(d)}}function F(a,b){q(D,b);q(B,a);for(var c in a)a.hasOwnProperty(c)&&(l[c]=z(c))}function I(){for(var a=0;a<B.length;a++)delete l[B[a]];x(i,"message",e);x(i,"message",c);m&&(m.parentNode.removeChild(m),l.frame=m=null)}var l=this,E=0,A={},u,j,t,D={},B={};F(a.remote,a.local);if(a.url){var b=a.url,m;j=a.channel||"default_"+Math.floor(1E4*Math.random());
t=s(b);w(i,"message",e);var h=/[\-\w]+\/\.\.\//,b=b.replace(/([^:])\/\//g,"$1/");if(!b.match(/^(http||https):\/\//)){var d="/"===b.substring(0,1)?"":r.pathname;"/"!==d.substring(d.length-1)&&(d=d.substring(0,d.lastIndexOf("/")+1));b=r.protocol+"//"+r.host+d+b}for(;h.test(b);)b=b.replace(h,"");var h=q({xdm_e:s(r.href),xdm_c:j},a.parameters||{}),g,d="",n=b.indexOf("#");-1!=n&&(d=b.substring(n),b=b.substring(0,n));n=[];for(g in h)h.hasOwnProperty(g)&&n.push(g+"="+encodeURIComponent(h[g]));g=b+(-1==b.indexOf("?")?
"?":"&")+n.join("&")+d;g=q({src:g,id:"ft_xdm_provider_"+j},a.props||{});h=l;b=a.container;d=y.createElement("IFRAME");b?"string"==typeof b&&(b=y.getElementById(b)):(q(d.style,{position:"absolute",top:"-9999px",left:"0"}),b=y.body);var n=g.src,G=g.style;g.src="javascript:false";G&&(delete g.style,q(d.style,G));d.frameBorder=0;for(var p in g)g.hasOwnProperty(p)&&d.setAttribute(p,g[p]);b.appendChild(d);d.src=n;h.frame=m=d;l.extendRpcMethods=F;l.destroy=I}else{p=i.parent;g={};b=r.search.substring(1).split("&");
for(d=b.length;d--;)h=b[d].split("="),g[h[0]]=decodeURIComponent(h[1]);h=g.xdm_e.replace(/["'<>\\]/g,"");j=g.xdm_c.replace(/["'<>\\]/g,"");t=s(h);u="postMessage"in p?p:p.document;w(i,"message",c);C(u,j+"-ready",t)}return l}}})(window);