(function(i,H){function v(){}function C(a,c,d){i.addEventListener?a.postMessage(c,d):setTimeout(function(){a.postMessage(c,d)},0)}function w(a,c,d){a.addEventListener?a.addEventListener(c,d,!1):a.attachEvent("on"+c,d)}function x(a,c,d){a.removeEventListener?a.removeEventListener(c,d,!1):a.detachEvent("on"+c,d)}function s(a){if(/^file:/.test(a))throw"The file:// protocol is not supported";var c=a.toLowerCase().match(/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/),a=c[2],d=c[3],c=c[4]||"";if("http:"==a&&":80"==
c||"https:"==a&&":443"==c)c="";return a+"//"+d+c}function q(a,c){for(var d in c)c.hasOwnProperty(d)&&(a[d]=c[d]);return a}var y=i.document,r=i.location,k=i.finamtrade;k||(i.finamtrade=k={});if(!k.XDM){if(!Array.isArray){var z=Object.prototype.toString;Array.isArray=function(a){return"[object Array]"==z.call(a)}}k.XDM=function(a){function c(e){var a;if(e.origin)a=s(e.origin);else if(e.uri)a=s(e.uri);else if(e.domain)a=r.protocol+"//"+e.domain;else throw"Unable to retrieve the origin of the event";
if(a==t&&e.data.substring(0,j.length+1)==j+" ")if(e=e.data.substring(j.length+1),e=JSON.parse(e),e.method){var b=e.id;a=D[e.method];e=e.params;if(a){var c,f;b?(c=function(a){c=v;k({id:b,result:a})},f=function(a,e){f=v;var c={id:b,error:{code:-32099,message:a}};e&&(c.error.data=e);k(c)}):c=f=v;Array.isArray(e)||(e=[e]);try{var d=a.apply(l,e.concat([c,f]));d!==H&&c(d)}catch(g){f(g.message)}}else b&&k({id:b,error:{code:-32601,message:"Procedure not found."}})}else d=A[e.id],e.error?d.error&&d.error(e.error):
d.success&&d.success(e.result),delete A[e.id]}function d(e){if(e.data==j+"-ready"&&(u="postMessage"in m.contentWindow?m.contentWindow:m.contentWindow.document,x(i,"message",d),w(i,"message",c),"function"==typeof a.onReady))a.onReady()}function k(a){C(u,j+" "+JSON.stringify(a),t)}function z(a){var c=Array.prototype.slice;return function(){var b=arguments,d=b.length,f,g={method:a};0<d&&"function"==typeof b[d-1]?(1<d&&"function"==typeof b[d-2]?(f={success:b[d-2],error:b[d-1]},g.params=c.call(b,0,d-2)):
(f={success:b[d-1]},g.params=c.call(b,0,d-1)),A[""+ ++E]=f,g.id=E):g.params=c.call(b,0);k(g)}}function F(a,b){q(D,b);q(B,a);for(var c in a)a.hasOwnProperty(c)&&(l[c]=z(c))}function I(){for(var a=0;a<B.length;a++)delete l[B[a]];x(i,"message",d);x(i,"message",c);m&&(m.parentNode.removeChild(m),l.frame=m=null)}var l=this,E=0,A={},u,j,t,D={},B={};F(a.remote,a.local);if(a.url){var b=a.url,m;j=a.channel||"default_"+Math.floor(1E4*Math.random());t=s(b);w(i,"message",d);var h=/[\-\w]+\/\.\.\//,b=b.replace(/([^:])\/\//g,
"$1/");if(!b.match(/^(http||https):\/\//)){var f="/"===b.substring(0,1)?"":r.pathname;"/"!==f.substring(f.length-1)&&(f=f.substring(0,f.lastIndexOf("/")+1));b=r.protocol+"//"+r.host+f+b}for(;h.test(b);)b=b.replace(h,"");var h=q({xdm_e:s(r.href),xdm_c:j},a.params||{}),g,f="",n=b.indexOf("#");-1!=n&&(f=b.substring(n),b=b.substring(0,n));n=[];for(g in h)h.hasOwnProperty(g)&&n.push(g+"="+encodeURIComponent(h[g]));g=b+(-1==b.indexOf("?")?"?":"&")+n.join("&")+f;g=q({src:g,id:"ft_xdm_provider_"+j},a.props||
{});h=l;b=a.container;f=y.createElement("IFRAME");b?"string"==typeof b&&(b=y.getElementById(b)):(q(f.style,{position:"absolute",top:"-9999px",left:"0"}),b=y.body);var n=g.src,G=g.style;g.src="javascript:false";G&&(delete g.style,q(f.style,G));f.frameBorder=0;for(var p in g)g.hasOwnProperty(p)&&f.setAttribute(p,g[p]);b.appendChild(f);f.src=n;h.frame=m=f;l.extendRpcMethods=F;l.destroy=I}else{p=i.parent;g={};b=r.search.substring(1).split("&");for(f=b.length;f--;)h=b[f].split("="),g[h[0]]=decodeURIComponent(h[1]);
h=g.xdm_e.replace(/["'<>\\]/g,"");j=g.xdm_c.replace(/["'<>\\]/g,"");t=s(h);u="postMessage"in p?p:p.document;w(i,"message",c);C(u,j+"-ready",t)}return l}}})(window);